@using CPS_Solution.Controllers;
@using CPS_Solution.EntityFramework;
@using CPS_Solution.Areas.Admin.Models;
@{
    Layout = null;
    List<Product> listproconfirm = ViewBag.listproconfirm;
    List<Hardware> ListHardWareProActive = ViewBag.ListHardWareProActive;
    List<string> listProductId = ViewBag.listProductId;
}
 <!-- iOS webapp icons -->
    <link rel="apple-touch-icon" href="touch-icon-iphone.png" />
    <link rel="apple-touch-icon" sizes="72x72" href="touch-icon-ipad.png" />
    <link rel="apple-touch-icon" sizes="114x114" href="touch-icon-retina.png" />

    <!-- CSS Reset -->
    <link rel="stylesheet" type="text/css" href="~/Areas/Admin/Dandelion/css/reset.css" media="screen" />
    <!--  Fluid Grid System -->
    <link rel="stylesheet" type="text/css" href="~/Areas/Admin/Dandelion/css/fluid.css" media="screen" />
    <!-- Theme Stylesheet -->
    <link rel="stylesheet" type="text/css" href="~/Areas/Admin/Dandelion/css/dandelion.theme.css" media="screen" />
    <!--  Main Stylesheet -->
    <link rel="stylesheet" type="text/css" href="~/Areas/Admin/Dandelion/css/dandelion.css" media="screen" />
    <!-- Demo Stylesheet -->
    <link rel="stylesheet" type="text/css" href="~/Areas/Admin/Dandelion/css/demo.css" media="screen" />
    <!-- jQuery JavaScript File -->
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/js/jquery-1.7.2.min.js"></script>
    <!-- jQuery-UI JavaScript Files -->
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/jui/js/jquery-ui-1.8.20.min.js"></script>
    <link rel="stylesheet" type="text/css" href="~/Areas/Admin/Dandelion/jui/css/jquery.ui.all.css" media="screen" />
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/jui/js/jquery.ui.timepicker.min.js"></script>
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/jui/js/jquery.ui.touch-punch.min.js"></script>
    <!-- Plugin Files -->
    <!-- FileInput Plugin -->
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/js/jquery.fileinput.js"></script>
    <!-- Placeholder Plugin -->
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/js/jquery.placeholder.js"></script>
    <!-- Mousewheel Plugin -->
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/js/jquery.mousewheel.min.js"></script>
    <!-- Scrollbar Plugin -->
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/js/jquery.tinyscrollbar.min.js"></script>
    <!-- Tooltips Plugin -->
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/plugins/tipsy/jquery.tipsy-min.js"></script>
    <link rel="stylesheet" href="~/Areas/Admin/Dandelion/plugins/tipsy/tipsy.css" />
    <!-- Demo JavaScript Files -->
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/js/demo/demo.icons.js"></script>
    <!-- Core JavaScript Files -->
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/js/core/dandelion.core.js"></script>
    <!-- Customizer JavaScript File (remove if not needed) -->
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/js/core/dandelion.customizer.js"></script>

    <!--  Demo JavaScript Files popup Ui Popup 
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/js/demo/demo.ui.js"></script>-->
    <!-- jGrowl Plugin   -->
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/plugins/jgrowl/jquery.jgrowl.min.js"></script>
    <link rel="stylesheet" href="~/Areas/Admin/Dandelion/plugins/jgrowl/jquery.jgrowl.css" media="screen" />

    <!-- DataTables Plugin -->
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/plugins/datatables/jquery.dataTables.min.js"></script>
    <!-- Demo JavaScript Files -->
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/js/demo/demo.tables.js"></script>
    <script type="text/javascript" src="@Url.Content("~/Areas/Admin/Dandelion/js/demo/demo.form.js")"></script>
    <!-- Chosen Plugin -->
    <script type="text/javascript" src="@Url.Content("~/Areas/Admin/Dandelion/plugins/chosen/chosen.jquery.js")"></script>
    <link rel="stylesheet" href="@Url.Content("~/Areas/Admin/Dandelion/plugins/chosen/chosen.css")" media="screen" />

    <!----------------------------- Lên datatable Plugin------------------------------------------>
    <script type="text/javascript" src="@Url.Content("~/Areas/Admin/Dandelion/js/jquery.debouncedresize.js")"></script>
    <script type="text/javascript" src="@Url.Content("~/Areas/Admin/Dandelion/js/jquery.metadata.js")"></script>
    @*   <script src="@Url.Content("~/Scripts/jquery-2.1.0.min.js")"></script> *@
    <script src="@Url.Content("~/Scripts/jquery-ui-1.10.4.min.js")"></script>
    <script src="@Url.Content("~/Scripts/jquery.unobtrusive-ajax.min.js")" type="text/javascript"></script>
<!------------------------------------------------------------------------------------------->
           <div class="da-panel collapsible">
            <div class="da-panel-header">
                <span class="da-panel-title">
                    <img src="~/Areas/Admin/Dandelion/images/icons/black/16/list.png" alt="">
                    Kích hoạt Laptop mới trong cơ sở dữ liệu.
                </span>

                <span class="da-panel-toggler"></span>
            </div>
            <div class="da-panel-content">
                <div id="da-ex-datatable-numberpaging_wrapper" class="dataTables_wrapper" role="grid">


                    <table id="da-ex-datatable-numberpaging" class="da-table dataTable" aria-describedby="da-ex-datatable-numberpaging_info">
                        <thead>
                            <tr role="row">
                                <th class="sorting_asc" role="columnheader" tabindex="0" aria-controls="da-ex-datatable-numberpaging" rowspan="1" colspan="1" aria-sort="ascending" aria-label="Rendering engine: activate to sort column descending" style="width: 40px;">ID</th>
                                <th class="sorting" role="columnheader" tabindex="0" aria-controls="da-ex-datatable-numberpaging" rowspan="1" colspan="1" aria-label="Browser: activate to sort column ascending" style="width: 180px;">Tên Laptop</th>
                                <th class="sorting" role="columnheader" tabindex="0" aria-controls="da-ex-datatable-numberpaging" rowspan="1" colspan="1" aria-label="Browser: activate to sort column ascending" style="width: 50px;">Lựa chọn</th>

                            </tr>
                        </thead>

                        <tbody role="alert" aria-live="polite" aria-relevant="all">

                            @if (listproconfirm != null)
                            {
                                foreach (Product h in listproconfirm)
                                {
                                <tr id="IdTr@(h.ID)" class="odd">

                                    <td class=" sorting_1">@h.ID</td>
                                    <td class=" ">
                                        <label style="width: 100px;">@h.Name</label></td>

                                    <td style="width: 20%;" class=" ">
                                        <input style="width:55px" onclick="showPopupEdit(@h.ID)" value="Kích Hoạt" class="da-button green">&nbsp&nbsp&nbsp
                                <input style="width:52px;text-align:center" onclick="HuyLaptop(@h.ID)" value="Hủy bỏ" class="da-button red">

                                        <!----------------Popup sửa sản phẩm đúng----------->
                                        <div id="Edit-@h.ID-Popup-div" style="display: none;">
                                            <div class="da-panel">
                                                <div class="da-panel-content" style="background: url(../Areas/Admin/Dandelion/images/bg/wood_pattern.jpg);">
                                                    <form class="da-form">
                                                        <div class="da-form-inline">
                                                            <div class="da-form-row" style="padding-left: 16px; padding-top: 8px; padding-bottom: 8px; text-align: center">
                                                                <label style="font-size: 20px; text-decoration: underline; font-weight: bolder">Tên Laptop</label>
                                                                <div class="da-form-item">
                                                                    <input name="idNameHard@(h.ID)" id="Laptopname@(h.ID)" value="@h.Name"  type="text" style="width:264px"><br />
                                                                    @Html.DropDownList("ProductList", ViewBag.ProductList as List<SelectListItem>, new { @onchange = "HideHardware(this)", @class = "chzn-select", id = @h.ID, @style = "width: 250px;" })
                                                                </div>
                                                            </div>
                                                            @if (h.CpuID != 0 && h.VgaID != 0 && h.HddID != 0 && h.RamID != 0 && h.DisplayID != 0)
                                                            {
                                                                <div id="linhkien@(h.ID)">
                                                                    <div class="da-form-row" style="padding-left: 16px; padding-top: 8px; padding-bottom: 8px; text-align: center">
                                                                        <label style="font-size: 16px; text-decoration: underline; font-weight: bolder">CPU</label>
                                                                        <div class="da-form-item">
                                                                            @* <span class="formNote">Tên thành phần</span>*@
                                                                            @{int cpu = 0;}
                                                                            @foreach (Hardware hard in ListHardWareProActive)
                                                                            {
                                                                                if (hard.ID == h.CpuID)
                                                                                {
                                                                                    {
                                                                                        List<SelectListItem> cpuL = (List<SelectListItem>)ViewBag.cpuList;

                                                                                        cpuL.RemoveAt(0);
                                                                                        for (int i = 0; i < cpuL.Count; i++)
                                                                                        {
                                                                                            if (cpuL[i].Value.Equals(h.CpuID.ToString()))
                                                                                            {
                                                                                                cpuL.RemoveAt(i);
                                                                                                break;
                                                                                            }
                                                                                        }

                                                                                        var itemdefault = new SelectListItem
                                                                                        {
                                                                                            Text = "Không chọn",
                                                                                            Value = "0"
                                                                                        };
                                                                                        var itemdefault1 = new SelectListItem
                                                                                        {
                                                                                            Text = h.strCPU,
                                                                                            Value = h.CpuID.ToString()
                                                                                        };
                                                                                        cpuL.Add(itemdefault);
                                                                                        cpuL.Add(itemdefault1);
                                                                                        cpuL.Reverse();
                                                                                        ViewBag.cpuList = cpuL;
                                                                                    }                    
                                                                                <input disabled  id="idCPUProduct@(h.ID)" name="@h.CpuID" value="@h.strCPU" type="text"  style="width:264px"> 
                                                                                @Html.DropDownList("CPUList", ViewBag.cpuList as List<SelectListItem>, new { @onchange = "DisableCPU(this)", @class = "chzn-select", id = "ddlCPU" + @h.ID, @style = "width: 250px;" })                                                      
                                                                                    cpu++;
                                                                                    break;
                                                                                }
                                                                            }
                                                                            @if (cpu == 0)
                                                                            {
                                                                                <input  id="idCPUProduct@(h.ID)" name="@h.CpuID" value="@h.strCPU" type="text"  style="width:264px">
                                                                                @Html.DropDownList("CPUList", ViewBag.cpuList as List<SelectListItem>, new { @class = "chzn-select", id = "ddlCPU" + @h.ID, @style = "width: 250px;" })
                                                                            }
                                                                        </div>
                                                                    </div>
                                                                    <div class="da-form-row" style="padding-left: 16px; padding-top: 8px; padding-bottom: 8px; text-align: center">
                                                                        <label style="font-size: 16px; text-decoration: underline; font-weight: bolder">VGA</label>
                                                                        <div class="da-form-item">
                                                                            @* <span class="formNote">Tên thành phần</span>*@
                                                                            @{int vga = 0;}
                                                                            @foreach (Hardware hard in ListHardWareProActive)
                                                                            {
                                                                                if (hard.ID == h.VgaID)
                                                                                {
                                                                                    {
                                                                                        List<SelectListItem> vgaL = (List<SelectListItem>)ViewBag.vgaList;

                                                                                        vgaL.RemoveAt(0);
                                                                                        for (int i = 0; i < vgaL.Count; i++)
                                                                                        {
                                                                                            if (vgaL[i].Value.Equals(h.VgaID.ToString()))
                                                                                            {
                                                                                                vgaL.RemoveAt(i);
                                                                                                break;
                                                                                            }
                                                                                        }

                                                                                        var itemdefault = new SelectListItem
                                                                                        {
                                                                                            Text = "Không chọn",
                                                                                            Value = "0"
                                                                                        };
                                                                                        var itemdefault1 = new SelectListItem
                                                                                        {
                                                                                            Text = h.strVGA,
                                                                                            Value = h.VgaID.ToString()
                                                                                        };
                                                                                        vgaL.Add(itemdefault);
                                                                                        vgaL.Add(itemdefault1);
                                                                                        vgaL.Reverse();
                                                                                        ViewBag.vgaList = vgaL;
                                                                                    }            
                                                                                <input disabled  id="idVGAProduct@(h.ID)" name="@h.VgaID" value="@h.strVGA" type="text"  style="width:264px">
                                                                                @Html.DropDownList("VGAList", ViewBag.vgaList as List<SelectListItem>, new { @onchange = "DisableVGA(this)", @class = "chzn-select", id = "ddlVGA" + @h.ID, @style = "width: 250px;" })
                                                                                    vga++;
                                                                                    break;
                                                                                }
                                                                            }
                                                                            @if (vga == 0)
                                                                            {
                                                                                <input  id="idVGAProduct@(h.ID)" name="@h.VgaID" value="@h.strVGA" type="text"  style="width:264px">
                                                                
                                                                                @Html.DropDownList("VGAList", ViewBag.vgaList as List<SelectListItem>, new { @class = "chzn-select", id = "ddlVGA" + @h.ID, @style = "width: 250px;" })
                                                                            }
                                                                        </div>
                                                                    </div>
                                                                    <div class="da-form-row" style="padding-left: 16px; padding-top: 8px; padding-bottom: 8px; text-align: center">
                                                                        <label style="font-size: 16px; text-decoration: underline; font-weight: bolder">HDD</label>
                                                                        <div class="da-form-item">
                                                                            @* <span class="formNote">Tên thành phần</span>*@
                                                                            @{int hdd = 0;}
                                                                            @foreach (Hardware hard in ListHardWareProActive)
                                                                            {
                                                                                if (hard.ID == h.HddID)
                                                                                {
                                                                                    {
                                                                                        List<SelectListItem> hddL = (List<SelectListItem>)ViewBag.hddList;

                                                                                        hddL.RemoveAt(0);
                                                                                        for (int i = 0; i < hddL.Count; i++)
                                                                                        {
                                                                                            if (hddL[i].Value.Equals(h.HddID.ToString()))
                                                                                            {
                                                                                                hddL.RemoveAt(i);
                                                                                                break;
                                                                                            }
                                                                                        }

                                                                                        var itemdefault = new SelectListItem
                                                                                        {
                                                                                            Text = "Không chọn",
                                                                                            Value = "0"
                                                                                        };
                                                                                        var itemdefault1 = new SelectListItem
                                                                                        {
                                                                                            Text = h.strHDD,
                                                                                            Value = h.HddID.ToString()
                                                                                        };
                                                                                        hddL.Add(itemdefault);
                                                                                        hddL.Add(itemdefault1);
                                                                                        hddL.Reverse();
                                                                                        ViewBag.hddList = hddL;
                                                                                    }                                                                                                                                                       
                                                                                <input disabled  id="idHDDProduct@(h.ID)" name="@h.HddID" value="@h.strHDD" type="text"  style="width:264px">
                                                                                @Html.DropDownList("HDDList", ViewBag.hddList as List<SelectListItem>, new { @onchange = "DisableHDD(this)", @class = "chzn-select", id = "ddlHDD" + @h.ID, @style = "width: 250px;" })                                                                   
                                                                                    hdd++;

                                                                                    break;
                                                                                }
                                                                            }
                                                                            @if (hdd == 0)
                                                                            {
                                                                                <input  id="idHDDProduct@(h.ID)" name="@h.HddID" value="@h.strHDD" type="text"  style="width:264px">
                                                               
                                                                                @Html.DropDownList("HDDList", ViewBag.hddList as List<SelectListItem>, new { @class = "chzn-select", id = "ddlHDD" + @h.ID, @style = "width: 250px;" })
                                                                            }


                                                                        </div>
                                                                    </div>
                                                                    <div class="da-form-row" style="padding-left: 16px; padding-top: 8px; padding-bottom: 8px; text-align: center">
                                                                        <label style="font-size: 16px; text-decoration: underline; font-weight: bolder">Ram</label>
                                                                        <div class="da-form-item large">
                                                                            @* <span class="formNote">Tên thành phần</span>*@
                                                                            @{int ram = 0;}
                                                                            @foreach (Hardware hard in ListHardWareProActive)
                                                                            {
                                                                                if (hard.ID == h.RamID)
                                                                                {
                                                                                    {
                                                                                        List<SelectListItem> ramL = (List<SelectListItem>)ViewBag.ramList;

                                                                                        ramL.RemoveAt(0);
                                                                                        for (int i = 0; i < ramL.Count; i++)
                                                                                        {
                                                                                            if (ramL[i].Value.Equals(h.RamID.ToString()))
                                                                                            {
                                                                                                ramL.RemoveAt(i);
                                                                                                break;
                                                                                            }
                                                                                        }

                                                                                        var itemdefault = new SelectListItem
                                                                                        {
                                                                                            Text = "Không chọn",
                                                                                            Value = "0"
                                                                                        };
                                                                                        var itemdefault1 = new SelectListItem
                                                                                        {
                                                                                            Text = h.strRAM,
                                                                                            Value = h.RamID.ToString()
                                                                                        };
                                                                                        ramL.Add(itemdefault);
                                                                                        ramL.Add(itemdefault1);
                                                                                        ramL.Reverse();
                                                                                        ViewBag.ramList = ramL;
                                                                                    }           
                                                                                <input disabled  id="idRamProduct@(h.ID)" name="@h.RamID" value="@h.strRAM" type="text" style="width:264px">
                                                                                @Html.DropDownList("RAMList", ViewBag.ramList as List<SelectListItem>, new { @onchange = "DisableRam(this)", @class = "chzn-select", id = "ddlRam" + @h.ID, @style = "width: 250px;" })
                                                                                    ram++;
                                                                                    break;
                                                                                }
                                                                            }
                                                                            @if (ram == 0)
                                                                            {
                                                                                <input  id="idRamProduct@(h.ID)" name="@h.RamID" value="@h.strRAM" type="text" style="width:264px">                                                                                                            
                                                                                @Html.DropDownList("RAMList", ViewBag.ramList as List<SelectListItem>, new { @class = "chzn-select", id = "ddlRam" + @h.ID, @style = "width: 250px;" })
                                                                            }
                                                                        </div>
                                                                    </div>
                                                                    <div class="da-form-row" style="padding-left: 16px; padding-top: 8px; padding-bottom: 8px; text-align: center">
                                                                        <label style="font-size: 16px; text-decoration: underline; font-weight: bolder">Display</label>
                                                                        <div class="da-form-item">
                                                                            @* <span class="formNote">Tên thành phần</span>*@
                                                                            @{int display = 0;}
                                                                            @foreach (Hardware hard in ListHardWareProActive)
                                                                            {
                                                                                if (hard.ID == h.DisplayID)
                                                                                {
                                                                                    {
                                                                                        List<SelectListItem> displayL = (List<SelectListItem>)ViewBag.displayList;

                                                                                        displayL.RemoveAt(0);
                                                                                        for (int i = 0; i < displayL.Count; i++)
                                                                                        {
                                                                                            if (displayL[i].Value.Equals(h.DisplayID.ToString()))
                                                                                            {
                                                                                                displayL.RemoveAt(i);
                                                                                                break;
                                                                                            }
                                                                                        }

                                                                                        var itemdefault = new SelectListItem
                                                                                        {
                                                                                            Text = "Không chọn",
                                                                                            Value = "0"
                                                                                        };
                                                                                        var itemdefault1 = new SelectListItem
                                                                                        {
                                                                                            Text = h.strDisplay,
                                                                                            Value = h.DisplayID.ToString()
                                                                                        };
                                                                                        displayL.Add(itemdefault);
                                                                                        displayL.Add(itemdefault1);
                                                                                        displayL.Reverse();
                                                                                        ViewBag.displayList = displayL;
                                                                                    }           
                                                                                <input disabled  id="idDisplayProduct@(h.ID)" name="@h.DisplayID" value="@h.strDisplay" type="text" style="width:264px">
                                                                                @Html.DropDownList("DISPLAYList", ViewBag.displayList as List<SelectListItem>, new { @onchange = "DisableDisplay(this)", @class = "chzn-select", id = "ddlDisplay" + @h.ID, @style = "width: 250px;" })
                                                                                    display++;
                                                                                    break;
                                                                                }
                                                                            }
                                                                            @if (display == 0)
                                                                            {
                                                                                <input  id="idDisplayProduct@(h.ID)" name="@h.DisplayID" value="@h.strDisplay" type="text" style="width:264px">  
                                                                                                                                                                      
                                                                                @Html.DropDownList("DISPLAYList", ViewBag.displayList as List<SelectListItem>, new { @class = "chzn-select", id = "ddlDisplay" + @h.ID, @style = "width: 250px;" })
                                                                            }
                                                                        </div>
                                                                    </div>
                                                                </div>                                                                                       
                                                                <div class="da-button-row">
                                                                    <input onclick="EditHardware(@h.ID)" type="button" value="Lưu" class="da-button green">
                                                                </div>
                                                            }
                                                            else
                                                            {
                                                                int check = 0;
                                                                foreach (string idStr in listProductId)
                                                                {
                                                                    if (h.ID.ToString().Equals(idStr.Trim()))
                                                                    {
                                                                        check++;
                                                                    }
                                                                }
                                                                if (check > 0)
                                                                {
                                                                <div class="da-form-row">
                                                                    <label style="font-size: 16px; text-decoration: underline; font-weight: bolder">Chú ý:</label>
                                                                    <div class="da-form-item">
                                                                        @* <span class="formNote">Tên thành phần</span>*@
                                                                        <a style="color: red;" href="/Admin/TrainingProduct">Click vào đây để xử lý linh kiện còn thiếu của Laptop</a>
                                                                    </div>
                                                                </div>
                                                                }
                                                                if (check == 0)
                                                                {
                                                                <div class="da-form-row">
                                                                    <label>Chú ý:</label>
                                                                    <div class="da-form-item">
                                                                        @* <span class="formNote">Tên thành phần</span>*@
                                                                        <a style="color: red;">Sản phẩm bị thiếu thông tin khi parse xin hãy hủy bỏ</a>
                                                                    </div>
                                                                </div>                                                 
                                                                }
                                                            }
                                                        </div>

                                                    </form>
                                                </div>
                                            </div>
                                            @*  <script type="text/javascript">
                                        var loai = $('#hiddenCodetype').val();
                                        $(document).ready(function () {
                                            $("#Hardware").autocomplete({
                                                source: function(request,response) {
                                                    $.ajax({
                                                        url: "../ConfirmNewHardware/AutoCompleteHardware",
                                                        type: "POST",
                                                        dataType: "json",
                                                        data: JSON.stringify({ term: request.term}),
                                                        contentType: 'application/json',
                                                        success: function (data) {
                                                            response($.map(data, function (item) {
                                                                return { label: item.Name, value: item.Name };
                                                            }))
                                                        }
                                                    })
                                                },
                                                messages: {
                                                    noResults: "", results: ""
                                                }
                                            });
                                        })
</script>*@
                                        </div>

                                        <!----------------Popup------------------>
                                    </td>

                                </tr>
                                }
                            }
                        </tbody>
                    </table>
                </div>
            </div>
        </div>
<script type="text/javascript">
    $(document).ready(function () {
        $('.ui-autocomplete').css("z-index", "1000");
    });

</script>
