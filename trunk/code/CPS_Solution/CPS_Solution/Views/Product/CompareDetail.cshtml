@model IEnumerable<CPS_Solution.EntityFramework.Product>

@{
    ViewBag.Title = "Kết quả so sánh chi tiết";
    Layout = "~/Views/Shared/_MainLayout.cshtml";
}

@section navigator {
<div id="top-image" class="top-image3">
    <div class="container">
        <div id="top-image-caption">
            <h2>so sánh chi tiết</h2>
        </div>
    </div>
</div>
}
<style type="text/css">
    .parent {
        position: relative;
    }

    .child {
        /* CSS for warpper */
        position: absolute;
        top: 0; right: 5px;
        width: 50px;
        height: 60px;
        background-color: #F7A191;
        border-radius: 10px;
        opacity: 0.8;
        /* CSS for text */
        text-align: center;
        vertical-align: middle;
        line-height: 60px;
        font-weight: bold;
        font-size: 30px;
    }

    .center {
        margin: auto;
        width: inherit;
    }

    .handle {
        cursor: move;
        text-align: center;
    }

    .sortable-with-handles {
        list-style-type: none;
    }

    .disable-field {
        background-color: rgb(15, 64, 113);
        text-align:center;
        color:#FFFFFF;
    }

    .data-field {
        text-align:center;
    }

    li.sortable-placeholder {
			border: 1px dashed rgb(152, 152, 152);
			background: none;
            height: 15px;
	}

    .topAttr {
        background: rgb(99,182,219);
		background: -moz-radial-gradient(center, ellipse cover,  rgba(99,182,219,1) 0%, rgba(48,157,207,1) 100%);
		background: -webkit-gradient(radial, center center, 0px, center center, 100%, color-stop(0%,rgba(99,182,219,1)), color-stop(100%,rgba(48,157,207,1)));
		background: -webkit-radial-gradient(center, ellipse cover,  rgba(99,182,219,1) 0%,rgba(48,157,207,1) 100%);
		background: -o-radial-gradient(center, ellipse cover,  rgba(99,182,219,1) 0%,rgba(48,157,207,1) 100%);
		background: -ms-radial-gradient(center, ellipse cover,  rgba(99,182,219,1) 0%,rgba(48,157,207,1) 100%);
		background: radial-gradient(ellipse at center,  rgba(99,182,219,1) 0%,rgba(48,157,207,1) 100%);
		filter: progid:DXImageTransform.Microsoft.gradient( startColorstr='#63b6db', endColorstr='#309dcf',GradientType=1 );
    }

    .winner {
        background-color: rgba(51, 153, 255, 0.75);     
    }

    .product-name {
        font-size:15px;
    }

    .center-info {
        text-align: center;
        vertical-align: middle;
    }

    td > span > .pull-left {
        margin-right: 10px;
    }
</style>

<div id="breadcrumbs">
    <div class="container">
        <div class="row">
            <div class="span8">
                <ul class="breadcrumb">
                    <li><a href="#">trang chủ</a><span class="divider">/</span></li>
                    <li><p>so sánh</p><span class="divider">/</span></li>
                    <li><p>so sánh ưu tiên</p></li>
                </ul>
            </div>
        </div>
    </div>
</div>

<div class="page-element">
        <div class="container">
            @*Tin nhan*@
            <div class="message-box info-message-box clearfix  fadeDown animated fadeInDown" 
                style="margin:0 auto; width:73%;">
                <div class="message-icon-box">
                    <i class="icon-info"></i>
                </div>
                <div class="message-container">
                    <p style="margin-top:8px; font-size:16px; color:rgb(0, 0, 0)">
                        Kéo thả để thay đổi vị trí các thành phần cấu hình. 
                        Hệ thống sẽ đề xuất sản phẩm theo tiêu chí ưu tiên của bạn.
                    </p>
                </div>
            </div>

            @*Chia thanh phan*@
            <div class="stylish-light-separator" style="margin-top:2%; margin-bottom:2%"></div>

            @*Bang so sanh*@
            <ul class="sortable-with-handles">
                @*Ten san pham*@
                <li class="disabled">
                    <table class="table table-bordered">
                        <tr>
                            <td style="width:20%; text-align:center; vertical-align:middle">Tên sản phẩm</td>
                            @foreach (var item in Model) {
                                <td style="width:25%; text-align:center; vertical-align:middle" class="product-name @item.ID">@Html.DisplayFor(modelItem => item.Name)</td>
                            }
                        </tr>
                    </table>
                </li>

                @*Thong tin CPU*@
                <li draggable="true" id="scoreCPU">
                    <table class="table table-bordered table-hover">
                        <tr>
                            <td style="width:20%" class="handle">
                                <span class="pull-left">
                                    <img src="~/Template/GFashion/img/order.png" style="margin-right:10px;">
                                </span>
                                Chip xử lý (CPU)
                            </td>
                            @foreach (var item in Model) {
                                <td style="width:25%" data-id="@item.ID">@Html.DisplayFor(modelItem => item.strCPU)</td>
                                <td class="hidden"><span class="cpuScore">@item.cpuScore</span></td>
                                <td class="hidden">@item.ID</td>
                            }
                        </tr>
                    </table>
                </li>

                @*Thong tin VGA*@
                <li draggable="true" id="scoreVGA">
                    <table class="table table-bordered table-hover">
                        <tr>
                            <td style="width:20%" class="handle">
                                <span class="pull-left">
                                    <img src="~/Template/GFashion/img/order.png" style="margin-right:10px;">
                                </span>
                                Card màn hình (VGA)
                            </td>
                            @foreach (var item in Model) {
                                <td style="width:25%" data-id="@item.ID">@Html.DisplayFor(modelItem => item.strVGA)</td>
                                <td class="hidden"><span class="cpuScore">@item.vgaScore</span></td>
                                <td class="hidden">@item.ID</td>
                            }
                        </tr>
                    </table>
                </li>

                @*Thong tin RAM*@
                <li draggable="true" id="scoreRAM">
                    <table class="table table-bordered table-hover">
                        <tr>
                            <td style="width:20%" class="handle">
                                <span class="pull-left">
                                    <img src="~/Template/GFashion/img/order.png" style="margin-right:10px;">
                                </span>
                                Bộ nhớ đệm (RAM)
                            </td>
                            @foreach (var item in Model) {
                                <td style="width:25%" data-id="@item.ID">@Html.DisplayFor(modelItem => item.strRAM)</td>
                                <td class="hidden"><span class="cpuScore">@item.ramScore</span></td>
                                <td class="hidden">@item.ID</td>
                            }
                        </tr>
                    </table>
                </li>

                @*Thong tin HDD*@
                <li draggable="true" id="scoreHDD">
                    <table class="table table-bordered table-hover">
                        <tr>
                            <td style="width:20%" class="handle">
                                <span class="pull-left">
                                    <img src="~/Template/GFashion/img/order.png" style="margin-right:10px;">
                                </span>
                                Ổ cứng (HDD)
                            </td>
                            @foreach (var item in Model) {
                                <td style="width:25%" data-id="@item.ID">@Html.DisplayFor(modelItem => item.strHDD)</td>
                                <td class="hidden"><span class="cpuScore">@item.hddScore</span></td>
                                <td class="hidden">@item.ID</td>
                            }
                        </tr>
                    </table>
                </li>

                @*Thong tin Display*@
                <li draggable="true" id="scoreDisplay">
                    <table class="table table-bordered table-hover">
                        <tr>
                            <td style="width:20%" class="handle">
                                <span class="pull-left">
                                    <img src="~/Template/GFashion/img/order.png" style="margin-right:10px;">
                                </span>
                                Độ phân giải (Sreen Solution)
                            </td>
                            @foreach (var item in Model) {
                                <td style="width:25%" data-id="@item.ID">@Html.DisplayFor(modelItem => item.strDisplay)</td>
                                <td class="hidden"><span class="cpuScore">@item.displayScore</span></td>
                                <td class="hidden">@item.ID</td>
                            }
                        </tr>
                    </table>
                </li>
            </ul>
        </div>
</div>

<script>
    $(document).ready(function () {
        updateClass();
        $(function () {
            $('.sortable-with-handles').sortable({
                handle: '.handle',
                items: ':not(.disabled)'
            }).bind('sortupdate', function () {
                updateClass();
                calc();
            });
        });
    });

    function updateClass() {
        var scoreCPU = $('#scoreCPU').index();
        var scoreVGA = $('#scoreVGA').index();
        var scoreRAM = $('#scoreRAM').index();
        var scoreHDD = $('#scoreHDD').index();
        var scoreDisplay = $('#scoreDisplay').index();

        if (scoreCPU == 1 || scoreCPU == 2) {
            $('#scoreCPU').addClass('topAttr');
        } else {
            $('#scoreCPU').removeClass('topAttr');
        }
        if (scoreVGA == 1 || scoreVGA == 2) {
            $('#scoreVGA').addClass('topAttr');
        } else {
            $('#scoreVGA').removeClass('topAttr');
        }
        if (scoreRAM == 1 || scoreRAM == 2) {
            $('#scoreRAM').addClass('topAttr');
        } else {
            $('#scoreRAM').removeClass('topAttr');
        }
        if (scoreHDD == 1 || scoreHDD == 2) {
            $('#scoreHDD').addClass('topAttr');
        } else {
            $('#scoreHDD').removeClass('topAttr');
        }
        if (scoreDisplay == 1 || scoreDisplay == 2) {
            $('#scoreDisplay').addClass('topAttr');
        } else {
            $('#scoreDisplay').removeClass('topAttr');
        }
    }

    function calc() {

        var products = $('.product-name');
        var attr01 = $('.topAttr')[0];
        var attr02 = $('.topAttr')[1];

        //Lay thong tin diem tung san pham
        if (products.length == 3) {
            //Product 1
            var pro01_attr01 = attr01.getElementsByTagName('span')[1].innerHTML;
            var pro01_attr02 = attr02.getElementsByTagName('span')[1].innerHTML;
            var pro01_attr03 = attr02.getElementsByTagName('td')[3].innerHTML;


            //Product 2
            var pro02_attr01 = attr01.getElementsByTagName('span')[2].innerHTML;
            var pro02_attr02 = attr02.getElementsByTagName('span')[2].innerHTML;
            var pro02_attr03 = attr02.getElementsByTagName('td')[6].innerHTML;

            //Product 3
            var pro03_attr01 = attr01.getElementsByTagName('span')[3].innerHTML;
            var pro03_attr02 = attr02.getElementsByTagName('span')[3].innerHTML;
            var pro03_attr03 = attr02.getElementsByTagName('td')[9].innerHTML;
        } else {
            //Product 1
            var pro01_attr01 = attr01.getElementsByTagName('span')[1].innerHTML;
            var pro01_attr02 = attr02.getElementsByTagName('span')[1].innerHTML;
            var pro01_attr03 = attr02.getElementsByTagName('td')[3].innerHTML;

            //Product 2
            var pro02_attr01 = attr01.getElementsByTagName('span')[2].innerHTML();
            var pro02_attr02 = attr02.getElementsByTagName('span')[2].innerHTML;
            var pro02_attr03 = attr02.getElementsByTagName('td')[6].innerHTML;
        }
        //Tinh diem cac tieu chi uu tien
        var pro01_score = parseFloat(pro01_attr01) + parseFloat(pro01_attr02);
        var pro02_score = parseFloat(pro02_attr01) + parseFloat(pro02_attr02);
        var pro03_score = parseFloat(pro03_attr01) + parseFloat(pro03_attr02);
        console.log(pro01_score, pro02_score, pro03_score)

        //So sanh san pham theo diem uu tien cao nhat
        var max = pro01_score;
        if (pro02_score > max)
            max = pro02_score
        if (pro03_score > max)
            max = pro03_score;

        //Highlight cac san pham co diem theo tieu chi uu tien cao nhat
        if (max == pro01_score) {
            $('.' + pro01_attr03).addClass("winner", 1000, "easeOutSine");
            $('.' + pro02_attr03).removeClass('winner');
            $('.' + pro03_attr03).removeClass('winner');
        } else if (max == pro02_score) {
            $('.' + pro02_attr03).addClass("winner", 1000, "easeOutSine");
            $('.' + pro01_attr03).removeClass('winner');
            $('.' + pro03_attr03).removeClass('winner');
        } else if (max == pro03_score) {
            $('.' + pro03_attr03).addClass("winner", 1000, "easeOutSine");
            $('.' + pro01_attr03).removeClass('winner');
            $('.' + pro02_attr03).removeClass('winner');
        }
        if (max == pro01_score && max == pro02_score) {
            $('.' + pro01_attr03).addClass("winner", 1000, "easeOutSine");
            $('.' + pro02_attr03).addClass("winner", 1000, "easeOutSine");
            $('.' + pro03_attr03).removeClass('winner');
        } else if (max == pro01_score && max == pro03_score) {
            $('.' + pro01_attr03).addClass("winner", 1000, "easeOutSine");
            $('.' + pro02_attr03).removeClass('winner');
            $('.' + pro03_attr03).addClass("winner", 1000, "easeOutSine");
        } else if (max == pro02_score && max == pro03_score) {
            $('.' + pro01_attr03).removeClass('winner');
            $('.' + pro02_attr03).addClass("winner", 1000, "easeOutSine");
            $('.' + pro03_attr03).addClass("winner", 1000, "easeOutSine");
        }
        if (max == pro01_score && max == pro02_score && max == pro03_score) {
            $('.' + pro01_attr03).addClass("winner", 1000, "easeOutSine");
            $('.' + pro02_attr03).addClass("winner", 1000, "easeOutSine");
            $('.' + pro03_attr03).addClass("winner", 1000, "easeOutSine");
        }
    }
</script>




