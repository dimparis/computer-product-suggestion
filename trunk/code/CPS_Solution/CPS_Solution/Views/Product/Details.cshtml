@model CPS_Solution.EntityFramework.Product

@{
    ViewBag.Title = "Chi tiết sản phẩm";
    Layout = "~/Views/Shared/_MainLayout.cshtml";
    double point = ViewBag.point;
    double pointLogin = ViewBag.pointLogin;
}
<script type="text/javascript">
    $(document).ready(function () {
        (function ($) {
            $.fn.jRating = function (op) {
                var defaults = {
                    /** String vars **/
                    bigStarsPath: '/Areas/Admin/Rating/image/stars.png', // path of the icon stars.png
                    smallStarsPath: '/Areas/Admin/Rating/image/small.png', // path of the icon small.png
                    phpPath: 'php/jRating.php', // path of the php file jRating.php
                    type: 'big', // can be set to 'small' or 'big'

                    /** Boolean vars **/
                    step: false, // if true, mouseover binded star by star,
                    isDisabled: false, // if true, user could not rate
                    showRateInfo: true, // show rates informations when cursor moves onto the plugin
                    canRateAgain: false, // if true, the user could rates {nbRates} times with jRating.. Default, 1 time
                    sendRequest: true, // send values to server

                    /** Integer vars **/
                    length: 5, // number of star to display
                    decimalLength: 0, // number of decimals.
                    rateMax: 20, // maximal rate - integer from 0 to 9999 (or more)
                    rateInfosX: -45, // relative position in X axis of the info box when mouseover
                    rateInfosY: 5, // relative position in Y axis of the info box when mouseover
                    nbRates: 1,

                    /** Functions **/
                    onSuccess: null, // Fires when the server response is ok
                    onError: null, // Fires when the server response is not ok
                    onClick: null // Fires when clicking on a star
                };

                if (this.length > 0)
                    return this.each(function () {
                        /*vars*/
                        var opts = $.extend(defaults, op),
                        newWidth = 0,
                        starWidth = 0,
                        starHeight = 0,
                        bgPath = '',
                        hasRated = false,
                        globalWidth = 0,
                        nbOfRates = opts.nbRates;

                        if ($(this).hasClass('jDisabled') || opts.isDisabled)
                            var jDisabled = true;
                        else
                            var jDisabled = false;

                        getStarWidth();
                        $(this).height(starHeight);

                        var average = parseFloat($(this).attr('data-average')), // get the average of all rates
                        idBox = parseInt($(this).attr('data-id')), // get the id of the box
                        widthRatingContainer = starWidth * opts.length, // Width of the Container
                        widthColor = average / opts.rateMax * widthRatingContainer, // Width of the color Container

                        quotient =
                        $('<div>',
                        {
                            'class': 'jRatingColor',
                            css: {
                                width: widthColor
                            }
                        }).appendTo($(this)),

                        average =
                        $('<div>',
                        {
                            'class': 'jRatingAverage',
                            css: {
                                width: 0,
                                top: -starHeight
                            }
                        }).appendTo($(this)),

                        jstar =
                        $('<div>',
                        {
                            'class': 'jStar',
                            css: {
                                width: widthRatingContainer,
                                height: starHeight,
                                top: -(starHeight * 2),
                                background: 'url(' + bgPath + ') repeat-x'
                            }
                        }).appendTo($(this));


                        $(this).css({ width: widthRatingContainer, overflow: 'hidden', zIndex: 1, position: 'relative' });

                        if (!jDisabled)
                            $(this).unbind().bind({
                                mouseenter: function (e) {
                                    var realOffsetLeft = findRealLeft(this);
                                    var relativeX = e.pageX - realOffsetLeft;
                                    if (opts.showRateInfo)
                                        var tooltip =
                                        $('<p>', {
                                            'class': 'jRatingInfos',
                                            html: getNote(relativeX) + ' <span class="maxRate">/ ' + opts.rateMax + '</span>',
                                            css: {
                                                top: (e.pageY + opts.rateInfosY),
                                                left: (e.pageX + opts.rateInfosX)
                                            }
                                        }).appendTo('body').show();
                                },
                                mouseover: function (e) {
                                    $(this).css('cursor', 'pointer');
                                },
                                mouseout: function () {
                                    $(this).css('cursor', 'default');
                                    if (hasRated) average.width(globalWidth);
                                    else average.width(0);
                                },
                                mousemove: function (e) {
                                    var realOffsetLeft = findRealLeft(this);
                                    var relativeX = e.pageX - realOffsetLeft;
                                    if (opts.step) newWidth = Math.floor(relativeX / starWidth) * starWidth + starWidth;
                                    else newWidth = relativeX;
                                    average.width(newWidth);
                                    if (opts.showRateInfo)
                                        $("p.jRatingInfos")
                                        .css({
                                            left: (e.pageX + opts.rateInfosX)
                                        })
                                        .html(getNote(newWidth) + ' <span class="maxRate">/ ' + opts.rateMax + '</span>');
                                },
                                mouseleave: function () {
                                    $("p.jRatingInfos").remove();
                                },
                                click: function (e) {
                                    var element = this;

                                    /*set vars*/
                                    hasRated = true;
                                    globalWidth = newWidth;
                                    nbOfRates--;

                                    if (!opts.canRateAgain || parseInt(nbOfRates) <= 0) $(this).unbind().css('cursor', 'default').addClass('jDisabled');

                                    if (opts.showRateInfo) $("p.jRatingInfos").fadeOut('fast', function () { $(this).remove(); });
                                    e.preventDefault();
                                    var rate = getNote(newWidth);
                                    average.width(newWidth);


                                    /** ONLY FOR THE DEMO, YOU CAN REMOVE THIS CODE **/
                                    $('.datasSent p').html('<strong>idBox : </strong>' + idBox + '<br /><strong>rate : </strong>' + rate + '<br /><strong>action :</strong> rating');
                                    $('.serverResponse p').html('<strong>Loading...</strong>');
                                    /** END ONLY FOR THE DEMO **/

                                    if (opts.onClick) opts.onClick(element, rate);

                                    if (opts.sendRequest) {
                                        $.post(opts.phpPath, {
                                            idBox: idBox,
                                            rate: rate,
                                            action: 'rating'
                                        },
                                        function (data) {
                                            if (!data.error) {
                                                /** ONLY FOR THE DEMO, YOU CAN REMOVE THIS CODE **/
                                                $('.serverResponse p').html(data.server);
                                                /** END ONLY FOR THE DEMO **/


                                                /** Here you can display an alert box,
                                                or use the jNotify Plugin :) http://www.myqjqueryplugins.com/jNotify
                                                exemple : */
                                                if (opts.onSuccess) opts.onSuccess(element, rate);
                                            }
                                            else {

                                                /** ONLY FOR THE DEMO, YOU CAN REMOVE THIS CODE **/
                                                $('.serverResponse p').html(data.server);
                                                /** END ONLY FOR THE DEMO **/

                                                /** Here you can display an alert box,
                                                or use the jNotify Plugin :) http://www.myqjqueryplugins.com/jNotify
                                                exemple : */
                                                if (opts.onError) opts.onError(element, rate);
                                            }
                                        },
                                        'json'
                                        );
                                    }

                                }
                            });

                        function getNote(relativeX) {
                            var noteBrut = parseFloat((relativeX * 100 / widthRatingContainer) * parseInt(opts.rateMax) / 100);
                            var dec = Math.pow(10, parseInt(opts.decimalLength));
                            var note = Math.round(noteBrut * dec) / dec;
                            return note;
                        };

                        function getStarWidth() {
                            switch (opts.type) {
                                case 'small':
                                    starWidth = 12; // width of the picture small.png
                                    starHeight = 5; // height of the picture small.png
                                    bgPath = opts.smallStarsPath;
                                    break;
                                default:
                                    starWidth = 23; // width of the picture stars.png
                                    starHeight = 20; // height of the picture stars.png
                                    bgPath = opts.bigStarsPath;
                            }
                        };

                        function findRealLeft(obj) {
                            if (!obj) return 0;
                            return obj.offsetLeft + findRealLeft(obj.offsetParent);
                        };
                    });

            }
        })(jQuery);
        $('#here').jRating({
            onClick: function (element, rate) {
                // alert(rate);
                var postData = { RatingPoint: rate };
                // Gửi điểm rating về để insert
                $.ajax({
                    type: "POST",
                    url: "/Product/AddNewRating",
                    data: postData,
                    success: function (data) {
                        $('#black-icon').html(data);
                    },
                });
            },
            onError: function () {
                alert("Có lỗi xảy ra, vui lòng thử lại sau!");
            }

        });

        $(".exemple4").jRating({
            isDisabled: true
        });

    });
</script>

<style>
    table {
        color: #333;
        font-family: Helvetica, Arial, sans-serif;
        width: 370px;
        border-collapse: collapse;
        border-spacing: 0;
    }

    td {
        border: 1px solid transparent; /* No more visible border */
        height: 30px;
        transition: all 0.3s; /* Simple transition for hover effect */
        padding-left: 5px;
        padding-right: 5px;
        font-family: 'Arial Unicode MS';
        font-weight: bolder;
    }

    th {
        background: #DFDFDF; /* Darken header a bit */
        font-weight: bold;
    }

    td {
        background: #FEFEFE;
        text-align: left;
    }

    /* Cells in even rows (2,4,6...) are one color */
    tr:nth-child(even) td {
        background: #F1F1F1;
    }

    /* Cells in odd rows (1,3,5...) are another (excludes header cells)  */
    tr:nth-child(odd) td {
        background: #FEFEFE;
    }

    tr td:hover {
        background: #666;
        color: #FFF;
    }
    /* Hover cell effect! */
</style>
@section navigator
{
    <div id="top-image" class="top-image3">
        <div class="container">
            <div id="top-image-caption">
                <h2>chi tiết sản phẩm</h2>
            </div>
        </div>
    </div>
}
<div class="page-element gray-element">

    <div class="container">

        <div class="row" style="margin-right: 15px">
            @*<h4 class="element-title">@Html.DisplayFor(model => model.Name)</h4>*@
            <div class="span4">
                <img src="~/Images/I/default.jpg" style="background-size: cover; height: 277px; width: 369px">
            </div>
            <div class="span4">
                <h4 style="overflow-wrap: break-word;">
                    <strong>Chức năng, cấu hình</strong>
                    <span style="font-style: italic; text-decoration: underline">@Model.Name</span>
                </h4>
                <table>
                    <tr>
                        <td>Giá</td>
                        <td>@Model.Price</td>
                    </tr>
                    <tr>
                        <td style="width: 25%">CPU</td>
                        <td style="width: 100%">@Model.strCPU sdfsdfsdfssdfsdfsdfsdfsd</td>
                    </tr>
                    <tr>
                        <td>RAM</td>
                        <td>@Model.strRAM</td>
                    </tr>
                    <tr>
                        <td>Đĩa cứng</td>
                        <td>@Model.strHDD</td>
                    </tr>
                    <tr>
                        <td>Đồ họa</td>
                        <td>@Model.strVGA</td>
                    </tr>
                    <tr>
                        <td>Màn hình</td>
                        <td>@Model.strDisplay</td>
                    </tr>
                    <tr>
                        <td>Đánh giá</td>
                        <td>10/10</td>
                    </tr>
                </table>
            </div>
            <div class="span4">
                <h4 style="overflow-wrap: break-word;">
                    <strong>sản phẩm cùng mức giá</strong>
                </h4>
                <img src="~/Images/I/default.jpg" style="background-size: cover; height: 277px; width: 369px">
            </div>
            <div class="span8">
                <h3 style="overflow-wrap: break-word;">
                    <strong>Mô tả sản phẩm</strong>
                </h3>
                <p>@Model.Description</p>
            </div>
            <div class="span4">
                <h4 style="overflow-wrap: break-word;">
                    <strong>sản phẩm tương tự</strong>
                </h4>
                <img src="~/Images/I/default.jpg" style="background-size: cover; height: 277px; width: 369px">
            </div>
            <div class="stylish-light-separator"></div>
        </div>
        @if(@Model.AliasProducts.Count>0)
        {               
                    @Html.Partial("TakeAliasProduct", Model.AliasProducts);
        }

    </div>
</div>
<link rel="stylesheet" type="text/css" href="@Url.Content("~/Areas/Admin/Rating/css/jRating.jquery.css")" media="screen" />
@*<!-- jQuery JavaScript File -->

    <script type="text/javascript" src="~/Areas/Admin/Dandelion/js/jquery-1.7.2.min.js"></script>
    <!-- jQuery-UI JavaScript Files -->
    <script type="text/javascript" src="~/Areas/Admin/Dandelion/jui/js/jquery-ui-1.8.20.min.js"></script>
 *@
